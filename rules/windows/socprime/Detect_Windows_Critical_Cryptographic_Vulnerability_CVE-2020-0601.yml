title: Detect Windows Critical Cryptographic Vulnerability (CVE-2020-0601)
description: This rule detect vulnerable CRYPT32.DLL library in your environment. NSA has discovered a critical vulnerability (CVE-2020-0601) affecting Microsoft WindowsÂ® cryptographic functionality.
status: stable
author: Roman Ranskyi
references:
    - https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-0601
    - https://gist.github.com/SwitHak/62fa7f8df378cae3a459670e3a18742d
    - https://media.defense.gov/2020/Jan/14/2002234275/-1/-1/0/CSA-WINDOWS-10-CRYPT-LIB-20190114.PDF
    - https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Exploit:Win32/CVE-2020-0601.A&ThreatID=2147749406
    - https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Exploit:Win32/CVE-2020-0601.B&threatId=-2147217889
logsource:
    product: windows
    service: sysmon
detection:
    selection1:
        EventID: 7
        file_hash:
        - E832E3A58B542E15A169B1545CE82451ACE19BD361FD81764383048528F9B540
        - 1676DE3980DF1D78E14B172989916570
    selection2:
        EventID: 7
        Hashes:
        - E832E3A58B542E15A169B1545CE82451ACE19BD361FD81764383048528F9B540
        - 1676DE3980DF1D78E14B172989916570
    keywords:
    - E832E3A58B542E15A169B1545CE82451ACE19BD361FD81764383048528F9B540
    - 1676DE3980DF1D78E14B172989916570
    condition: selection1 or selection2 or keywords
fields:
    - Hashes
falsepositives:
    - none
level: critical
tags:
    - attack.defense_evasion
    - attack.t1211
